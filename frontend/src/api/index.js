import axios from 'axios';
import axiosInstance from './axiosInstance';
import authService from './authService';
import userService from './userService';
import projectService from './projectService';
import organizationService from './organizationService';
import strategyService from './strategyService';
import participantService from './participantService';
import generalService from './generalService';
import dashboardService from './dashboardService';
import metaDataService from './metaDataService';
import kdspIIService from './kdspIIService';
import hrService from './hrService';
import paymentService from './paymentService';
import projectWorkFlowService from './projectWorkFlowService';
import approvalService from './approvalService';
import contractorService from './contractorService'; 
import reportsService from './reportsService';
import budgetService from './budgetService';

// Public API service (no authentication required)
const publicApiService = {
  getStatsOverview: async (filters = {}) => {
    try {
      const response = await axiosInstance.get('/public/stats/overview', { params: filters });
      return response.data;
    } catch (error) {
      console.error("Failed to fetch public stats overview:", error);
      throw error;
    }
  },
  getProjects: async (filters = {}) => {
    try {
      const response = await axiosInstance.get('/public/projects', { params: filters });
      return response.data;
    } catch (error) {
      console.error("Failed to fetch public projects:", error);
      throw error;
    }
  },
  getSubCountyStats: async (filters = {}) => {
    try {
      const response = await axiosInstance.get('/public/stats/by-subcounty', { params: filters });
      return response.data;
    } catch (error) {
      console.error("Failed to fetch sub-county stats:", error);
      throw error;
    }
  },
  getDepartmentStats: async (filters = {}) => {
    try {
      const response = await axiosInstance.get('/public/stats/by-department', { params: filters });
      return response.data;
    } catch (error) {
      console.error("Failed to fetch department stats:", error);
      throw error;
    }
  },
}; // ðŸ‘ˆ Import the new service

export const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || '/api';
export const FILE_SERVER_BASE_URL = import.meta.env.VITE_FILE_SERVER_BASE_URL || '/api';

const apiService = {
  ...projectService,
  kdspIIService,
  auth: authService,
  users: userService,
  organization: organizationService,
  strategy: strategyService,
  participants: participantService,
  general: generalService,
  dashboard: dashboardService,
  metadata: metaDataService,
  hr: hrService,
  paymentRequests: paymentService,
  workflow: projectWorkFlowService,
  approval: approvalService,
  contractors: contractorService,
  reports: reportsService, // ðŸ‘ˆ Mount the reportsService here
  budgets: budgetService, // ðŸ‘ˆ Mount the budgetService here
  public: publicApiService, // ðŸ‘ˆ Mount the publicApiService here
};

export { axiosInstance };

export default apiService;